# M1 and M2 requirements
# Versions aligned with Airflow 2.8.1 constraints where applicable

# Core dependencies (install first)
python-dotenv==1.0.0
boto3==1.33.13
arxiv==2.1.0

# Data processing (aligned with Airflow constraints) - install before ML packages
numpy==1.24.4
pandas==2.1.4

# PyTorch (MUST be installed before any packages that import torch)
# Install these FIRST before layoutparser or detectron2
torch==2.1.0
torchvision==0.16.0

# PDF Processing
PyMuPDF==1.23.26
pdfplumber==0.10.3
pytesseract==0.3.10
camelot-py==0.11.0
# Note: If you need ghostscript support for camelot, install separately:
# macOS: brew install ghostscript
# Ubuntu: sudo apt-get install ghostscript
Pillow==10.2.0
opencv-python==4.8.1.78

# Layout Detection (requires torch/torchvision to be installed first)
layoutparser==0.3.4
# detectron2 must be installed AFTER torch/torchvision are installed
# Install with: pip install 'git+https://github.com/facebookresearch/detectron2.git'
# Or use pre-built wheel: pip install detectron2 -f https://dl.fbaipublicfiles.com/detectron2/wheels/cpu/torch2.1/index.html

# Testing & utilities (aligned with Airflow constraints)
pytest==7.4.4
pytest-asyncio==0.23.3
tqdm==4.66.1

# Dependency conflict resolution
pyparsing>=3.1.0  # Required by pydot 4.0.1 (conflicts with Airflow's 3.0.9)

# Pinecone (for vector search)
pinecone

# Airflow
apache-airflow==2.8.1 --constraint "https://raw.githubusercontent.com/apache/airflow/constraints-2.8.1/constraints-3.9.txt"